{% extends 'base.html.twig' %}

{% block title %}Liste des Affectations Wacdo{% endblock %}

{% block metadescription %}
    
{% endblock %}

{% block stylesheets %}
    
{% endblock %}

{% block body %}

<header class="flex">
    <div class="logo_wacdo flex container">
        <div>
            <img src="{{asset('images/logo.png')}}" alt="logo wacdo">
            <a href="{{path('app_logout')}}" title="déconnexion"><button>Se déconnecter</button></a>
        </div>
        <a href="{{path('app_app')}}" title="Retour à l'accueil"><button>Retour</button></a>
    </div>
</header>

<h1>Liste des affectations</h1>

<div class="form_filtre_restaurant container flex">
    <form action="{{path('filtre_poste_affectation')}}" method="post" class="flex">
        <select name="filtre" id="">
            <option value="All">Tous les postes</option>
            {% for poste in postes %}
                <option value="{{poste.id}}">{{poste.libelle}}</option>
            {% endfor %}
        </select>
        <input type="submit" value="✅">
    </form>
    <form action="{{path('filtre_debut_affectation')}}" method="post" class="flex">
        <select name="filtre" id="">
            <option value="All">Toutes les dates de début</option>
            {% for debut in debuts %}
                <option value="{{debut.debut | date('Y-m-d')}}">{{debut.debut | date('d/m/Y')}}</option>
            {% endfor %}
        </select>
        <input type="submit" value="✅">
    </form>
    <form action="{{path('filtre_fin_affectation')}}" method="post" class="flex">
        <select name="filtre" id="">
            <option value="All">Toutes les dates de fin</option>
            {% for fin in fins %}
                <option value="{{fin.fin | date('Y-m-d')}}">{{fin.fin | date('d/m/Y')}}</option>
            {% endfor %}
        </select>
        <input type="submit" value="✅">
    </form>
</div>

<div class="container">
        <table>
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Prénom</th>
                    <th>Poste</th>
                    <th>Restaurant</th>
                    <th>Ville</th>
                    <th>Date de début</th>
                    <th>Date de Fin</th>
                </tr>

            </thead>
            <tbody>
                {% for affectation in affectations %}
                    <tr>
                        <td> {{affectation.collaborateur.nom}} </td>
                        <td> {{affectation.collaborateur.prenom}} </td>
                        <td> {{affectation.fonction.libelle}} </td>
                        <td> {{affectation.restaurant.nom}} </td>
                        <td> {{affectation.restaurant.ville}} </td>
                        <td> {{affectation.debut | date('d/m/Y')}} </td>
                        <td> {% if affectation.fin == "" %} En cours {% else %} {{affectation.fin | date('d/m/Y')}} {% endif %}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
